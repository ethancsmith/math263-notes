
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>7: Systems of first order ODEs. &#8212; MATH 263: Numerical differential equations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '07-systems_of_odes';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8: Higher order initial value problems." href="08-higher_order_odes.html" />
    <link rel="prev" title="6: Predictor–corrector methods." href="06-predictor-corrector_methods.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00-intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/gcc_seal.png" class="logo__image only-light" alt="MATH 263: Numerical differential equations - Home"/>
    <img src="_static/gcc_seal.png" class="logo__image only-dark pst-js-only" alt="MATH 263: Numerical differential equations - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00-intro.html">
                    MATH 263: Numerical differential equations.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-direction_fields.html">1: Direction fields.</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-euler_method.html">2: Euler’s method.</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-error_analysis.html">3: Error analysis.</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-runge-kutta_methods.html">4: Runge–Kutta methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-multistep_methods.html">5: Multistep methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-predictor-corrector_methods.html">6: Predictor–corrector methods.</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7: Systems of first order ODEs.</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-higher_order_odes.html">8: Higher order initial value problems.</a></li>
<li class="toctree-l1"><a class="reference internal" href="pendulum.html">Physical example: Simple gravity pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-adaptive_methods.html">9: Adaptive methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-shooting_method.html">10: Boundary value problems and the shooting method.</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-finite_differences.html">11: Finite difference methods for boundary value problems.</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-stiffness.html">12: Stiffness.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ethancsmith/math263-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ethancsmith/math263-notes/issues/new?title=Issue%20on%20page%20%2F07-systems_of_odes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/07-systems_of_odes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7: Systems of first order ODEs.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example">An example.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-errors-with-vector-norms">Measuring errors with vector norms.</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="systems-of-first-order-odes">
<h1>7: Systems of first order ODEs.<a class="headerlink" href="#systems-of-first-order-odes" title="Link to this heading">#</a></h1>
<section id="an-example">
<h2>An example.<a class="headerlink" href="#an-example" title="Link to this heading">#</a></h2>
<p>Consider the system of equations</p>
<div class="math notranslate nohighlight" id="equation-first-order-system-example">
<span class="eqno">(20)<a class="headerlink" href="#equation-first-order-system-example" title="Link to this equation">#</a></span>\[\begin{split}\frac{\mathrm{d}x}{\mathrm{d}t} &amp;= x + z,\\
\frac{\mathrm{d}y}{\mathrm{d}t} &amp;= x + y,\\
\frac{\mathrm{d}z}{\mathrm{d}t} &amp;= -2x - z.\end{split}\]</div>
<p>Here it is assumed that <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> are differentiable functions of <span class="math notranslate nohighlight">\(t\)</span>.
To specify a unique solution to the system, it is sufficient to impose initial conditions on each function at a given point, say <span class="math notranslate nohighlight">\(x(0) = 1\)</span>, <span class="math notranslate nohighlight">\(y(0) = -1/2\)</span>, and <span class="math notranslate nohighlight">\(z(0) = -1\)</span>, for example.</p>
<p>Since humans are much better at holding onto to one object at time, it is convenient (and conceptually more illuminating) to place collect all 3 scalar-valued functions into a vector-valued function <span class="math notranslate nohighlight">\(\boldsymbol r = \langle x, y, z\rangle\)</span>.<br />
Now recall from multivariable calculus that the derivative of a vector-valued function is the vector of derivatives of its scalar component functions.
In particular, we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\mathrm{d}\boldsymbol r}{\mathrm{d}t} 
= \lim_{h\to 0}\frac{\boldsymbol r(t+h) - \boldsymbol r(t)}{h}
= \begin{bmatrix}
\displaystyle\lim_{h\to 0}\frac{x(t+h) - x(t)}{h}\\
\displaystyle\lim_{h\to 0}\frac{y(t+h) - y(t)}{h}\\
\displaystyle\lim_{h\to 0}\frac{z(t+h) - z(t)}{h}
\end{bmatrix}
=\begin{bmatrix}
\displaystyle\frac{\mathrm{d}x}{\mathrm{d}t}\\
\displaystyle\frac{\mathrm{d}y}{\mathrm{d}t}\\
\displaystyle\frac{\mathrm{d}z}{\mathrm{d}t}
\end{bmatrix}.
\end{equation*}\]</div>
<p>Note that we write our vectors as columns when displayed, but use the angle-bracket row notation common in multivariable calculus texts as a spacing-saving device for in-line presentation.
We also take the liberty of collecting the right-hand sides of <a class="reference internal" href="#equation-first-order-system-example">(20)</a> into a single vector, writing</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\boldsymbol f(t, \boldsymbol r) = \begin{bmatrix}
x + z,\\
x + y,\\
-2x - z
\end{bmatrix}.
\end{equation*}\]</div>
<p>Furthermore, the initial conditions <span class="math notranslate nohighlight">\(x(0) = 1\)</span>, <span class="math notranslate nohighlight">\(y(0) = -1/2\)</span>, and <span class="math notranslate nohighlight">\(z(0) = -1\)</span> maybe expressed more compactly as <span class="math notranslate nohighlight">\(\boldsymbol r(0) = \langle 1, -1/2, -1\rangle\)</span>.</p>
<p>Now recall that the definition of a vector-valued derivative naturally yields the linear approximation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\boldsymbol r(t_0+h) \approx \boldsymbol r(t_0) + h\dot{\boldsymbol r}(t_0)
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\dot{\boldsymbol r}(t_0) = \frac{\mathrm{d}\boldsymbol r}{\mathrm{d}t}\big|_{t=t_0}\)</span>.
This of course means that we have the obvious vector-valued extension of Euler’s method, namely</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\boldsymbol r_{i+1} = \boldsymbol r_i + h \boldsymbol f(t_i, \boldsymbol r_i).
\end{equation*}\]</div>
<p>Appropriately replacing scalar-valued functions by vector-valued function, we can write down vector-valued versions of all of our numerical methods.
For example, the vector-valued extension of RK4 is simply</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\boldsymbol r_{i+1} = \boldsymbol r_i + 
    \frac{h}{6}\big(\boldsymbol k_1 + 2\boldsymbol k_2 + 2\boldsymbol k_3 + \boldsymbol k_4\big),
\end{equation*}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\boldsymbol k_1 &amp;= \boldsymbol f(t_i, \boldsymbol r_i),\\
\boldsymbol k_2 &amp;= \boldsymbol f\big(t_i + h/2, \boldsymbol r_i + h\boldsymbol k_1/2\big),\\
\boldsymbol k_3 &amp;= \boldsymbol f\big(t_i + h/2, \boldsymbol r_i + h\boldsymbol k_2/2\big),\\
\boldsymbol k_4 &amp;= \boldsymbol f(t_i + h, \boldsymbol r_i + h\boldsymbol k_3).
\end{align*}\]</div>
<p>Fortunately, many higher-level software packages (e.g., NumPy) have built-in routines and overloaded operators for manipulating vectors as though they were scalars.
Since we were careful with our numerical method implementations, this means that our code already works for systems of ODEs.  All we need to do is feed the routines appropriately shaped arrays.
We demonstrate this below for the system <a class="reference internal" href="#equation-first-order-system-example">(20)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load modules</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">math263</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define IVP parameters</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># solve with Euler and RK4 methods</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ti</span><span class="p">,</span> <span class="n">r_euler</span> <span class="o">=</span> <span class="n">math263</span><span class="o">.</span><span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">ti</span><span class="p">,</span> <span class="n">r_rk4</span> <span class="o">=</span> <span class="n">math263</span><span class="o">.</span><span class="n">rk4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make various plots for each method combined into one figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;dark_background&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac{\mathrm</span><span class="si">{d}</span><span class="s2">\boldsymbol</span><span class="si">{r}</span><span class="s2">}{\mathrm</span><span class="si">{d}</span><span class="s2">t} = \langle x+z, x+y, -2x-z\rangle$, &quot;</span>
    <span class="sa">r</span><span class="s2">&quot;$\boldsymbol</span><span class="si">{r}</span><span class="s2">(0) = \langle 1, -1/2, -1\rangle$&quot;</span>
<span class="p">)</span>

<span class="c1"># construct x, y, and z vs. t plot for Euler</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">r_euler</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">r_euler</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">r_euler</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="s2">&quot;ro:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="s2">&quot;go:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="s2">&quot;bo:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Euler solution&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># construct parametric plot of r = &lt;x, y, z&gt; for Euler</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xi</span><span class="p">,</span>
    <span class="n">yi</span><span class="p">,</span>
    <span class="n">zi</span><span class="p">,</span>
    <span class="s2">&quot;o:&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\mathbf</span><span class="si">{r}</span><span class="s2">(t)=\langle x(t), y(t), z(t)\rangle$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">box</span><span class="o">.</span><span class="n">x0</span> <span class="o">-=</span> <span class="mf">0.1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># construct x, y, and z vs. t plot for RK4</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">r_rk4</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">r_rk4</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">r_rk4</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="s2">&quot;ro:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="s2">&quot;go:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="s2">&quot;bo:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;RK4 solution&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># construct parametric plot of r = &lt;x, y, z&gt; for RK4</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xi</span><span class="p">,</span>
    <span class="n">yi</span><span class="p">,</span>
    <span class="n">zi</span><span class="p">,</span>
    <span class="s2">&quot;o:&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\mathbf</span><span class="si">{r}</span><span class="s2">(t)=\langle x(t), y(t), z(t)\rangle$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">box</span><span class="o">.</span><span class="n">x0</span> <span class="o">-=</span> <span class="mf">0.1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9158c482800cfda6ade594442f979c8711094d5024c26ecc5711e25448a52137.png" src="_images/9158c482800cfda6ade594442f979c8711094d5024c26ecc5711e25448a52137.png" />
</div>
</div>
</section>
<section id="measuring-errors-with-vector-norms">
<h2>Measuring errors with vector norms.<a class="headerlink" href="#measuring-errors-with-vector-norms" title="Link to this heading">#</a></h2>
<p>Suppose more generally that <span class="math notranslate nohighlight">\(\boldsymbol r = \langle x_1, \dots, x_m\rangle\)</span>, and we seek a solution to the IVP</p>
<div class="math notranslate nohighlight" id="equation-first-order-vector-ivp-normal-form">
<span class="eqno">(21)<a class="headerlink" href="#equation-first-order-vector-ivp-normal-form" title="Link to this equation">#</a></span>\[\begin{split}\frac{\mathrm d\boldsymbol r}{\mathrm dt} &amp;= f(t, \boldsymbol r)\\
\boldsymbol r(a) &amp;= \boldsymbol r_0\end{split}\]</div>
<p>over the <span class="math notranslate nohighlight">\(t\)</span>-interval <span class="math notranslate nohighlight">\([a, b]\)</span>.
To understand errors in higher-dimensional spaces it is helpful to establish the concept of a vector norm.</p>
<div class="proof definition admonition" id="definition-0">
<p class="admonition-title"><span class="caption-number">Definition 3 </span></p>
<section class="definition-content" id="proof-content">
<p>Suppose that <span class="math notranslate nohighlight">\(\boldsymbol v = \langle v_1,\dots, v_n\rangle\)</span> is a vector in <span class="math notranslate nohighlight">\(n\)</span>-dimensional (real or complex) space.
The <strong><span class="math notranslate nohighlight">\(p\)</span>-norm</strong> of <span class="math notranslate nohighlight">\(\boldsymbol v\)</span> is the nonnegative real number</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
|\boldsymbol v|_p = \begin{cases}
\displaystyle\left(\sum_{i=1}^n |v_i|^p\right)^{1/p} &amp; \text{if } p\in (0,\infty),\\
\displaystyle\max_{1\le i\le n}\{|v_i|\} &amp; \text{if } p = \infty.
\end{cases}
\end{equation*}\]</div>
</section>
</div><p>Vector norms provide a sense of distance in vector spaces that is somewhat akin to a ruler.
In particular, we define the <span class="math notranslate nohighlight">\(p\)</span>-distance between two vectors, say <span class="math notranslate nohighlight">\(\boldsymbol v\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol w\)</span>, to be the real scalar <span class="math notranslate nohighlight">\(|\boldsymbol v - \boldsymbol w|_p\)</span>.
Since there are infinitely many choices of <span class="math notranslate nohighlight">\(p\)</span>, there are infinitely many choices of “ruler.”
Deciding which choice makes the most sense depends on the application.
For example, if <span class="math notranslate nohighlight">\(\boldsymbol v\)</span> is a “position vector” in ordinary 3-dimensional space, then the choice <span class="math notranslate nohighlight">\(p=2\)</span> might make sense as it corresponds to the usual euclidean distance.
However, there are many situations where the vector <span class="math notranslate nohighlight">\(\boldsymbol v\)</span> is just an “artificial” construct holding a bunch of disparate scalars together for easy manipulation.
In such cases, it probably makes more sense to measure distances with the <span class="math notranslate nohighlight">\(\infty\)</span>-norm.</p>
<p>Since <a class="reference internal" href="#equation-first-order-system-example">(20)</a> can be solved analytically, we solve the system with SymPy.
We then compute the absolute error in our RK4 solution at each step <span class="math notranslate nohighlight">\(i\)</span> with both the 2-norm and the <span class="math notranslate nohighlight">\(\infty\)</span>-norm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve the IVP symbolically with the sympy library</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">ode</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
    <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
    <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span>
<span class="p">]</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
<span class="n">soln</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span>
    <span class="n">ode</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># lambdify the symbolic solution</span>
<span class="n">sym_x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">])</span>
<span class="n">sym_y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">soln</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">])</span>
<span class="n">sym_z</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">soln</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">])</span>
<span class="n">tvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="c1"># tabulate errors for RK4</span>
<span class="n">rvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">sym_x</span><span class="p">(</span><span class="n">ti</span><span class="p">),</span> <span class="n">sym_y</span><span class="p">(</span><span class="n">ti</span><span class="p">),</span> <span class="n">sym_z</span><span class="p">(</span><span class="n">ti</span><span class="p">)]</span>
<span class="n">error_vecs</span> <span class="o">=</span> <span class="n">rvals</span> <span class="o">-</span> <span class="n">r_rk4</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">errors_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error_vecs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">errors_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error_vecs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span> <span class="n">errors_2</span><span class="p">,</span> <span class="n">errors_inf</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Global </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">-norm and infinity-norm errors for RK4 solution.&quot;</span><span class="p">)</span>
<span class="n">hdrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;t_i&quot;</span><span class="p">,</span> <span class="s2">&quot;|r(t_i) - r_i|_2&quot;</span><span class="p">,</span> <span class="s2">&quot;|r(t_i) - r_i|_inf&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">hdrs</span><span class="p">,</span>
        <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;mixed_grid&quot;</span><span class="p">,</span>
        <span class="n">floatfmt</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.0f&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5f&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5e&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5e&quot;</span><span class="p">],</span>
        <span class="n">showindex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Global 2-norm and infinity-norm errors for RK4 solution.
┍━━━━━┯━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━┑
│   i │     t_i │   |r(t_i) - r_i|_2 │   |r(t_i) - r_i|_inf │
┝━━━━━┿━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━┥
│   0 │ 0.00000 │        0.00000e+00 │          0.00000e+00 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   1 │ 0.62832 │        8.54539e-04 │          7.23567e-04 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   2 │ 1.25664 │        1.58544e-03 │          1.14773e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   3 │ 1.88496 │        3.36021e-03 │          2.38391e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   4 │ 2.51327 │        5.28139e-03 │          4.28826e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   5 │ 3.14159 │        5.95742e-03 │          5.54975e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   6 │ 3.76991 │        5.12717e-03 │          4.34641e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   7 │ 4.39823 │        5.53913e-03 │          4.01258e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   8 │ 5.02655 │        8.94407e-03 │          6.34824e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│   9 │ 5.65487 │        1.18700e-02 │          9.63224e-03 │
├─────┼─────────┼────────────────────┼──────────────────────┤
│  10 │ 6.28319 │        1.19106e-02 │          1.10934e-02 │
┕━━━━━┷━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━┙
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06-predictor-corrector_methods.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6: Predictor–corrector methods.</p>
      </div>
    </a>
    <a class="right-next"
       href="08-higher_order_odes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8: Higher order initial value problems.</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example">An example.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-errors-with-vector-norms">Measuring errors with vector norms.</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ethan Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>