
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5: Multistep methods. &#8212; MATH 263: Numerical differential equations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '05-multistep_methods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6: Predictor–corrector methods." href="06-predictor-corrector_methods.html" />
    <link rel="prev" title="4: Runge–Kutta methods." href="04-runge-kutta_methods.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00-intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/gcc_seal.png" class="logo__image only-light" alt="MATH 263: Numerical differential equations - Home"/>
    <img src="_static/gcc_seal.png" class="logo__image only-dark pst-js-only" alt="MATH 263: Numerical differential equations - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00-intro.html">
                    MATH 263: Numerical differential equations.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-direction_fields.html">1: Direction fields.</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-euler_method.html">2: Euler’s method.</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-error_analysis.html">3: Error analysis.</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-runge-kutta_methods.html">4: Runge–Kutta methods.</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5: Multistep methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-predictor-corrector_methods.html">6: Predictor–corrector methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-systems_of_odes.html">7: Systems of first order ODEs.</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-higher_order_odes.html">8: Higher order initial value problems.</a></li>
<li class="toctree-l1"><a class="reference internal" href="pendulum.html">Physical example: Simple gravity pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-adaptive_methods.html">9: Adaptive methods.</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-shooting_method.html">10: Boundary value problems and the shooting method.</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-finite_differences.html">11: Finite difference methods for boundary value problems.</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-stiffness.html">12: Stiffness.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ethancsmith/math263-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ethancsmith/math263-notes/issues/new?title=Issue%20on%20page%20%2F05-multistep_methods.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/05-multistep_methods.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5: Multistep methods.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adamsbashforth-2-step-method">Adams–Bashforth 2-step method.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adamsbashforth-4-step-method">Adams–Bashforth 4-step method.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages">Advantages and disadvantages.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-implementation">Python implementation.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example.</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="multistep-methods">
<h1>5: Multistep methods.<a class="headerlink" href="#multistep-methods" title="Link to this heading">#</a></h1>
<p>The methods that we have considered so far are called <strong>single-step methods</strong> because the point <span class="math notranslate nohighlight">\((x_{i+1}, y_{i+1})\)</span> is computed using only information from the previous step, namely <span class="math notranslate nohighlight">\((x_i, y_i)\)</span>.
In particular, the methods have all depended on a formula of the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_{i+1} = y_i + h\phi(x_i, y_i, h).
\end{equation*}\]</div>
<p>These methods are also called <strong>starting methods</strong> because the initial-value condition <span class="math notranslate nohighlight">\(y(x_0)=y_0\)</span> gives enough information to use these methods from the start.
On the other hand, <strong>multistep methods</strong> use more than one of the previously computed <span class="math notranslate nohighlight">\(y_j\)</span>.
An <strong><span class="math notranslate nohighlight">\(m\)</span>-step method</strong> would use the previous <span class="math notranslate nohighlight">\(m\)</span> values: <span class="math notranslate nohighlight">\((x_i,y_i), (x_{i-1},y_{i-1}),\dots, (x_{i-m+1},y_{i-m+1})\)</span>.
A <strong>linear <span class="math notranslate nohighlight">\(m\)</span>-step method</strong> takes the form</p>
<div class="math notranslate nohighlight" id="equation-linear-multistep-form">
<span class="eqno">(14)<a class="headerlink" href="#equation-linear-multistep-form" title="Link to this equation">#</a></span>\[y_{i+1} = \sum_{j=1}^m\alpha_jy_{i+1-j} + h\sum_{j=0}^m\beta_jf(x_{i+1-j}, y_{i+1-j}).\]</div>
<p>Clearly such a method cannot be used until <span class="math notranslate nohighlight">\(m\)</span> previous values are known.
For this reason, these methods must be paired with a starting method and are themselves called <strong>continuing methods</strong>.
However, there is an additional wrinkle if <span class="math notranslate nohighlight">\(\beta_0\ne 0\)</span>.
In particular, if <span class="math notranslate nohighlight">\(\beta_0\ne 0\)</span>, then <span class="math notranslate nohighlight">\(y_{i+1}\)</span> appears on both sides of the defining equation.
Therefore, we say that the method is <strong>explicit</strong> if <span class="math notranslate nohighlight">\(\beta_0=0\)</span> and <strong>implicit</strong> otherwise.
If the method is implicit and the function <span class="math notranslate nohighlight">\(f(x, y)\)</span> is linear in <span class="math notranslate nohighlight">\(y\)</span>, then it is easy to solve for <span class="math notranslate nohighlight">\(y_{i+1}\)</span> once the specific IVP is given, but in practice this is often not the case.
We will consider implicit methods in the next lecture.
For now, we concentrate on the case of explicit methods.
Some of the most popular explicit linear multistep methods are the <em>Adams–Bashforth methods</em>, which set <span class="math notranslate nohighlight">\(\beta_0=0\)</span> and <span class="math notranslate nohighlight">\(\alpha_j=0\)</span> for <span class="math notranslate nohighlight">\(j\ge 2\)</span>.</p>
<section id="adamsbashforth-2-step-method">
<h2>Adams–Bashforth 2-step method.<a class="headerlink" href="#adamsbashforth-2-step-method" title="Link to this heading">#</a></h2>
<p>For a <span class="math notranslate nohighlight">\(2\)</span>-step Adams—Bashforth method, equation <a class="reference internal" href="#equation-linear-multistep-form">(14)</a> simplifies to</p>
<div class="math notranslate nohighlight" id="equation-2-step-form">
<span class="eqno">(15)<a class="headerlink" href="#equation-2-step-form" title="Link to this equation">#</a></span>\[y_{i+1} = \alpha_1y_i + h\big(\beta_1f(x_i,y_i) + \beta_2f(x_{i-1},y_{i-1})\big).\]</div>
<p>The idea then is to force this formula to be exact for the first 3 terms of the Taylor series of the true solution <span class="math notranslate nohighlight">\(y\)</span>.
This will ensure that the local truncation error for the method is <span class="math notranslate nohighlight">\(O(h^3)\)</span> as <span class="math notranslate nohighlight">\(h\to 0\)</span>.
Note that with only <span class="math notranslate nohighlight">\(3\)</span> parameters to determine (viz, <span class="math notranslate nohighlight">\(\alpha_1, \beta_1, \beta_2)\)</span>, this is the best that can be done.
By linearity, it is enough to make it exact for the cases <span class="math notranslate nohighlight">\(y(x)=1\)</span>, <span class="math notranslate nohighlight">\(y(x)=x\)</span>, and <span class="math notranslate nohighlight">\(y(x)=x^2\)</span>.
If <span class="math notranslate nohighlight">\(y(x)=1\)</span>, then <span class="math notranslate nohighlight">\(f(x,y(x)) = y'(x) = 0\)</span>, and so the equation <a class="reference internal" href="#equation-2-step-form">(15)</a> becomes</p>
<div class="math notranslate nohighlight" id="equation-ab2-condition-1">
<span class="eqno">(16)<a class="headerlink" href="#equation-ab2-condition-1" title="Link to this equation">#</a></span>\[1=\alpha_1.\]</div>
<p>Similarly, if <span class="math notranslate nohighlight">\(y(x)=x\)</span>, then <span class="math notranslate nohighlight">\(y'(x)=1\)</span>, and <a class="reference internal" href="#equation-2-step-form">(15)</a> becomes</p>
<div class="math notranslate nohighlight" id="equation-ab2-condition-2">
<span class="eqno">(17)<a class="headerlink" href="#equation-ab2-condition-2" title="Link to this equation">#</a></span>\[x_{i+1}=\alpha_1 x_i + h(\beta_1+\beta_2).\]</div>
<p>Finally, if <span class="math notranslate nohighlight">\(y(x)=x^2\)</span>, then <span class="math notranslate nohighlight">\(y'(x)=2x\)</span>, and <a class="reference internal" href="#equation-2-step-form">(15)</a> becomes</p>
<div class="math notranslate nohighlight" id="equation-ab2-condition-3">
<span class="eqno">(18)<a class="headerlink" href="#equation-ab2-condition-3" title="Link to this equation">#</a></span>\[x_{i+1}^2 = \alpha_1x_i^2+ h(2\beta_1x_i + 2\beta_2x_{i-1}).\]</div>
<p>Now, equations <a class="reference internal" href="#equation-ab2-condition-1">(16)</a>, <a class="reference internal" href="#equation-ab2-condition-2">(17)</a>, and <a class="reference internal" href="#equation-ab2-condition-3">(18)</a> must hold for all values of <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(h\)</span>.
Choosing <span class="math notranslate nohighlight">\(x_{i}=1\)</span> and <span class="math notranslate nohighlight">\(h=1\)</span> so that <span class="math notranslate nohighlight">\(x_{i-1}=0\)</span> and <span class="math notranslate nohighlight">\(x_{i+1}=2\)</span>, we arrive at the system of equations</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
1&amp;=\alpha_1,\\
2&amp;=\alpha_1+\beta_1+\beta_2,\\
4&amp;=\alpha_1+2\beta_1.
\end{align*}\]</div>
<p>Solving the system yields <span class="math notranslate nohighlight">\(\alpha_1=1\)</span>, <span class="math notranslate nohighlight">\(\beta_1=3/2\)</span>, and <span class="math notranslate nohighlight">\(\beta_2=-1/2\)</span>.
The <strong>Adams–Bashforth two-step method (AB2)</strong> is therefore defined by the recurrence</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_{i+1} = y_i + \frac{h}{2}\big(3y_i' - y_{i-1}'\big),
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_i' = f(x_i, y_i)\)</span> for each <span class="math notranslate nohighlight">\(i\ge 1\)</span>.</p>
<p>As we noted above, the local truncation error for the method is <span class="math notranslate nohighlight">\(O(h^3)\)</span> as <span class="math notranslate nohighlight">\(h\to 0\)</span>.
This makes AB2 an order <span class="math notranslate nohighlight">\(2\)</span> method.
Thus, it should be paired with a starter method whose order of accuracy is at least <span class="math notranslate nohighlight">\(2\)</span> such as Heun’s modified Euler method.</p>
</section>
<section id="adamsbashforth-4-step-method">
<h2>Adams–Bashforth 4-step method.<a class="headerlink" href="#adamsbashforth-4-step-method" title="Link to this heading">#</a></h2>
<p>In a similar manner, one may derive the <strong>Adams–Bashforth four-step method (AB4)</strong>, which is defined by the recurrence</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_{i+1}=y_i+\frac{h}{24}\big(55y_i'-59y_{i-1}'+37y_{i-2}'-9y_{i-3}'\big)
\end{equation*}\]</div>
<p>and has local truncation error that is <span class="math notranslate nohighlight">\(O(h^5)\)</span> as <span class="math notranslate nohighlight">\(h\to 0\)</span>.
Thus, it should be paired with an order <span class="math notranslate nohighlight">\(4\)</span> starting method such as the classical RK4 method.</p>
</section>
<section id="advantages-and-disadvantages">
<h2>Advantages and disadvantages.<a class="headerlink" href="#advantages-and-disadvantages" title="Link to this heading">#</a></h2>
<p>The disadvantage of a multistep method is that it is typically slightly more difficult to implement than a single-step method.
It even requires a single-step method to get started.
However, there tends to be a major gain in order of accuracy per work.
We usually measure the work per step of a numerical method based on the number of times that we need to evaluate the “right-hand side” function <span class="math notranslate nohighlight">\(f(x,y)\)</span>.
The typical single-step Runge-Kutta method of order 2 (e.g., Heun’s modified Euler method) requires 2 functional evaluations per step.
We compare this to the Adams–Bashforth 2-step method which has the same order of accuracy and only requires one additional functional evaluation per step since it saves the evaluations from previous steps until it is finished with them.
Furthermore, since the error <span class="math notranslate nohighlight">\(|y(x_i)-y_i|\)</span> tends to increase with <span class="math notranslate nohighlight">\(i\)</span>, it is reasonable to hope that a multistep may have better accuracy (not just order of accuracy) by mere fact that it explicitly incorporates more accurate previous data when approximating <span class="math notranslate nohighlight">\(y_{i+1}\)</span>.</p>
</section>
<section id="python-implementation">
<h2>Python implementation.<a class="headerlink" href="#python-implementation" title="Link to this heading">#</a></h2>
<p>Our Python implementation of the Adams–Bashforth 2-step method uses Heun’s modified Euler method as starter.
The code is included in the <code class="docutils literal notranslate"><span class="pre">math263</span></code> module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">ab2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    numerically solves the IVP</span>
<span class="sd">        y&#39; = f(x,y), y(a)=y0</span>
<span class="sd">    over the interval [a, b] via n steps of second order Adams–Bashforth method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">y0</span><span class="p">)))</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="c1"># take first step with Heun&#39;s MEM</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k1</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1"># begin multistepping</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span>
        <span class="c1"># step f-vals down to get ready for next step</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="example">
<h2>Example.<a class="headerlink" href="#example" title="Link to this heading">#</a></h2>
<p>We now conduct an empirical comparison of AB2 with Heun’s modified Euler method (MEM) using the IVP</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y'&amp;=y-x^2+1,\\
y(0)&amp;=1/2
\end{align*}\]</div>
<p>as a test case.
First we use both methods to solve the problem over the interval <span class="math notranslate nohighlight">\([0,2]\)</span> in <span class="math notranslate nohighlight">\(n=10\)</span> steps.
We then present the global truncation errors <span class="math notranslate nohighlight">\(e_i=|y(x_i) - y_i|\)</span> for each method at each step in a table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">timeit</span> <span class="kn">import</span> <span class="n">timeit</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">import</span> <span class="nn">math263</span>

<span class="c1"># define IVP parameters</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># solve the IVP symbolically with the sympy library</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ode</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">soln</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">y</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="n">y0</span><span class="p">})</span>
<span class="n">sym_y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">soln</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">])</span>

<span class="c1"># numerically solve the IVP with n=10 steps of forward Euler and n=10 steps of RK4</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y_mem</span> <span class="o">=</span> <span class="n">math263</span><span class="o">.</span><span class="n">mem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y_ab2</span> <span class="o">=</span> <span class="n">math263</span><span class="o">.</span><span class="n">ab2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># tabulate the results</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Comparison of global errors for MEM and AB2</span><span class="se">\</span>
<span class="s2"> across interval for step-size h = </span><span class="si">{</span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sym_y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_mem</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sym_y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_ab2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="n">hdrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;x_i&quot;</span><span class="p">,</span> <span class="s2">&quot;MEM global error&quot;</span><span class="p">,</span> <span class="s2">&quot;AB2 global error&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">hdrs</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;mixed_grid&quot;</span><span class="p">,</span> <span class="n">floatfmt</span><span class="o">=</span><span class="s2">&quot;0.5f&quot;</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison of global errors for MEM and AB2 across interval for step-size h = 0.2.
┍━━━━━┯━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━┑
│   i │     x_i │   MEM global error │   AB2 global error │
┝━━━━━┿━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━┥
│   0 │ 0.00000 │            0.00000 │            0.00000 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   1 │ 0.20000 │            0.00330 │            0.00330 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   2 │ 0.40000 │            0.00717 │            0.00229 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   3 │ 0.60000 │            0.01170 │            0.00020 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   4 │ 0.80000 │            0.01699 │            0.00295 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   5 │ 1.00000 │            0.02317 │            0.00750 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   6 │ 1.20000 │            0.03036 │            0.01391 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   7 │ 1.40000 │            0.03871 │            0.02277 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   8 │ 1.60000 │            0.04839 │            0.03486 │
├─────┼─────────┼────────────────────┼────────────────────┤
│   9 │ 1.80000 │            0.05956 │            0.05115 │
├─────┼─────────┼────────────────────┼────────────────────┤
│  10 │ 2.00000 │            0.07242 │            0.07292 │
┕━━━━━┷━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━┙
</pre></div>
</div>
</div>
</div>
<p>We now compare the global error for AB2 at the right endpoint of the interval with that of MEM as we shrink the step-size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute abs errors at right endpoint for various step-sizes</span>
<span class="n">base</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">max_exp</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="p">[</span><span class="n">base</span><span class="o">**</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">)]</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">num_steps</span><span class="p">]</span>
<span class="n">mem_errors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">math263</span><span class="o">.</span><span class="n">mem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sym_y</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">num_steps</span>
<span class="p">]</span>
<span class="n">ab2_errors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">math263</span><span class="o">.</span><span class="n">ab2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sym_y</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">num_steps</span>
<span class="p">]</span>
<span class="c1"># compare size of error to size at previous step-size</span>
<span class="n">mem_cutdown</span> <span class="o">=</span> <span class="p">[</span><span class="n">mem_errors</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">mem_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">mem_cutdown</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">ab2_cutdown</span> <span class="o">=</span> <span class="p">[</span><span class="n">ab2_errors</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ab2_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">ab2_cutdown</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># tabulate the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Comparison of global errors |y_n - y(</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">)| for various step-sizes.&quot;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">mem_errors</span><span class="p">,</span> <span class="n">mem_cutdown</span><span class="p">,</span> <span class="n">ab2_errors</span><span class="p">,</span> <span class="n">ab2_cutdown</span><span class="p">]</span>
<span class="n">hdrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;step-size&quot;</span><span class="p">,</span> <span class="s2">&quot;MEM global error&quot;</span><span class="p">,</span> <span class="s2">&quot;cutdown&quot;</span><span class="p">,</span> <span class="s2">&quot;AB2 global error&quot;</span><span class="p">,</span> <span class="s2">&quot;cutdown&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">hdrs</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;mixed_grid&quot;</span><span class="p">,</span> <span class="n">floatfmt</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.7f&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison of global errors |y_n - y(2)| for various step-sizes.
┍━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━┑
│   step-size │   MEM global error │   cutdown │   AB2 global error │   cutdown │
┝━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━┥
│   0.2000000 │       7.241732e-02 │           │       7.291525e-02 │           │
├─────────────┼────────────────────┼───────────┼────────────────────┼───────────┤
│   0.0200000 │       7.797255e-04 │  0.010767 │       1.179610e-03 │  0.016178 │
├─────────────┼────────────────────┼───────────┼────────────────────┼───────────┤
│   0.0020000 │       7.846676e-06 │  0.010063 │       1.226335e-05 │  0.010396 │
├─────────────┼────────────────────┼───────────┼────────────────────┼───────────┤
│   0.0002000 │       7.851535e-08 │  0.010006 │       1.230993e-07 │  0.010038 │
├─────────────┼────────────────────┼───────────┼────────────────────┼───────────┤
│   0.0000200 │       7.851320e-10 │  0.010000 │       1.231354e-09 │  0.010003 │
├─────────────┼────────────────────┼───────────┼────────────────────┼───────────┤
│   0.0000020 │       7.706724e-12 │  0.009816 │       1.189537e-11 │  0.009660 │
┕━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━┙
</pre></div>
</div>
</div>
</div>
<p>We also compare the empirical average running time for our implementations as the number of steps increases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_trials</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mem_times</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">math263</span><span class="o">.</span><span class="n">mem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">base</span><span class="o">**</span><span class="n">j</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="n">num_trials</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_trials</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">ab2_times</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">timeit</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">math263</span><span class="o">.</span><span class="n">ab2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">base</span><span class="o">**</span><span class="n">j</span><span class="p">),</span> <span class="n">number</span><span class="o">=</span><span class="n">num_trials</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_trials</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># tabulate the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Comparison of average compute time for various step-sizes.&quot;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">num_steps</span><span class="p">,</span> <span class="n">mem_times</span><span class="p">,</span> <span class="n">ab2_times</span><span class="p">]</span>
<span class="n">hdrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;num steps&quot;</span><span class="p">,</span> <span class="s2">&quot;MEM time (secs)&quot;</span><span class="p">,</span> <span class="s2">&quot;AB2 time (secs)&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">hdrs</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;mixed_grid&quot;</span><span class="p">,</span> <span class="n">floatfmt</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.0f&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5f&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5f&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison of average compute time for various step-sizes.
┍━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━┑
│   num steps │   MEM time (secs) │   AB2 time (secs) │
┝━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━┥
│          10 │           0.00005 │           0.00004 │
├─────────────┼───────────────────┼───────────────────┤
│         100 │           0.00039 │           0.00028 │
├─────────────┼───────────────────┼───────────────────┤
│        1000 │           0.00408 │           0.00291 │
├─────────────┼───────────────────┼───────────────────┤
│       10000 │           0.04027 │           0.02924 │
├─────────────┼───────────────────┼───────────────────┤
│      100000 │           0.39935 │           0.29024 │
├─────────────┼───────────────────┼───────────────────┤
│     1000000 │           4.02434 │           2.91846 │
┕━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━┙
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04-runge-kutta_methods.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4: Runge–Kutta methods.</p>
      </div>
    </a>
    <a class="right-next"
       href="06-predictor-corrector_methods.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6: Predictor–corrector methods.</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adamsbashforth-2-step-method">Adams–Bashforth 2-step method.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adamsbashforth-4-step-method">Adams–Bashforth 4-step method.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages">Advantages and disadvantages.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-implementation">Python implementation.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example.</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ethan Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>